<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <!-- Bootstrap CSS -->
    <link th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" rel="stylesheet"/>
    <title>新規会員登録</title>
</head>
<body>

<h1>新規会員登録</h1>

<!-- エラーメッセージ -->
<div th:if="${errorMessages != null}">
    <ul>
        <li th:if="${#fields.hasErrors('account')}" th:errors="*{account}"></li>
        <li th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></li>
        <li th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></li>
        <li th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></li>
        <li th:each="errorMessage : ${errorMessages}" th:text="${errorMessage}"></li>
    </ul>
</div>

<!-- 新規会員登録フォーム -->
<form th:action="@{/user/add}" method="post" th:object="${userForm}">

    <!-- エラーメッセージ -->
    <div th:if="${validationErrors != null || accountError != null}">
        <ul>
            <li th:if="${#fields.hasErrors('account')}" th:errors="*{account}"></li>
            <li th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></li>
            <li th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></li>
            <li th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></li>
            <li th:if="${accountError != null}" th:text="${accountError}"></li>
        </ul>
    </div>

    <!-- 入力フォーム -->
    <div>
        <p>
            <label for="account">アカウント：</label><br>
            <input type="text" id="account" th:field="*{account}">
        </p>

        <p>
            <label for="password">パスワード：</label><br>
            <input type="password" id="password" th:field="*{password}">
        </p>

        <p>
            <label for="confirmPassword">パスワード（確認用）：</label><br>
            <input type="password" id="confirmPassword" th:field="*{confirmPassword}">
        </p>

        <p>
            <label for="name">氏名：</label><br>
            <input type="text" id="name" th:field="*{name}">
        </p>

        <p>
            <button type="submit">登録</button>
        </p>
    </div>
</form>

<script>
    // パスワード確認チェック
    document.querySelector("form").addEventListener("submit", function(e) {
        const pw = document.getElementById("password").value;
        const confirmPw = document.getElementById("confirmPassword").value;
        if (pw !== confirmPw) {
            alert("パスワードと確認用パスワードが一致しません");
            e.preventDefault();
        }
    });
</script>

<!-- webjar -->
<script th:href="@{/webjars/jquery/3.3.1/js/jquery.min.js}"></script>
<script th:href="@{/webjars/bootstrap/5.1.3/js/bootstrap.min.js}"></script>
</body>
</html>