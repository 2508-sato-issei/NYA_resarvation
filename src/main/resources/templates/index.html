<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <!-- Bootstrap CSS -->
    <link th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" rel="stylesheet"/>
    <title>ホーム</title>
</head>
<body>
<!-- 共通メニューバーの読み込み -->
<div th:replace="fragments/navbar :: navbar"></div>

<h1>ホーム</h1>

<!-- 検索フォーム -->
<div>
    <form th:action="@{/search}" method="get">

        <label for="area">エリア：</label>
        <select name="area" id="area" th:value="${searchForm.area}">
            <option value="">-- 選択してください --</option>
            <option value="東京" th:selected="${searchForm.area == '東京'}">東京</option>
            <option value="神奈川" th:selected="${searchForm.area == '神奈川'}">神奈川</option>
            <option value="愛知" th:selected="${searchForm.area == '愛知'}">愛知</option>
            <option value="大阪" th:selected="${searchForm.area == '大阪'}">大阪</option>
            <option value="京都" th:selected="${searchForm.area == '京都'}">京都</option>
            <option value="福岡" th:selected="${searchForm.area == '福岡'}">福岡</option>
        </select>

        <label for="genre">ジャンル：</label>
        <select name="genre" id="genre" th:value="${searchForm.genre}">
            <option value="">-- 選択してください --</option>
            <option value="焼肉" th:selected="${searchForm.genre == '焼肉'}">焼肉</option>
            <option value="寿司" th:selected="${searchForm.genre == '寿司'}">寿司</option>
            <option value="居酒屋" th:selected="${searchForm.genre == '居酒屋'}">居酒屋</option>
            <option value="イタリアン" th:selected="${searchForm.genre == 'イタリアン'}">イタリアン</option>
            <option value="ラーメン" th:selected="${searchForm.genre == 'ラーメン'}">ラーメン</option>
            <option value="カフェ" th:selected="${searchForm.genre == 'カフェ'}">カフェ</option>
        </select>

        <label for="headcount">人数：</label>
        <select name="headcount" id="headcount" th:value="${searchForm.headcount}">
            <option value="">-- 選択してください --</option>
            <option th:each="i : ${#numbers.sequence(1, 99)}"
                    th:value="${i}"
                    th:text="${i} + '名'"
                    th:selected="${searchForm.headcount == i}">
            </option>
        </select>

        <button type="submit">検索</button>
    </form>
</div>

<!-- 人気エリア・ジャンル・店舗 -->
<div>
    <table>
        <thead>
        <tr>
            <th>人気エリア</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="popularArea : ${popularAreas}">
            <td th:text="${popularArea.area}"></td>
        </tr>
        </tbody>
    </table>

    <table>
        <thead>
        <tr>
            <th>人気ジャンル</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="popularGenre : ${popularGenres}">
            <td th:text="${popularGenre.genre}"></td>
        </tr>
        </tbody>
    </table>

    <table>
        <thead>
        <tr>
            <th>人気店舗</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="popularRestaurant : ${popularRestaurants}">
            <a th:href="@{'/restaurant/' + ${popularRestaurant.id}}"
               th:text="${popularRestaurant.name}"></a>
        </tr>
        </tbody>
    </table>
</div>


<div th:if="${#authorization.expression('isAuthenticated()')}" class="d-flex gap-2">
    <form th:action="@{/mypage}" method="get">
        <button type="submit" class="btn btn-outline-primary">マイページ</button>
    </form>
    <form th:action="@{/logout}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit" class="btn btn-outline-danger">ログアウト</button>
    </form>
</div>

<!-- 未ログイン時のみ表示 -->
<div th:if="${!#authorization.expression('isAuthenticated()')}">
    <a th:href="@{/login}" class="btn btn-primary me-2">ログイン</a>
</div>
<!-- webjar -->
<script th:href="@{/webjars/jquery/3.3.1/js/jquery.min.js}"></script>
<script th:href="@{/webjars/bootstrap/5.1.3/js/bootstrap.min.js}"></script>
</body>
</html>